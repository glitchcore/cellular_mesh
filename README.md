В рамках open call на секцию [ML Art](https://mlart.org), которая будет проходить на [датафесте 2020](https://datafest.ru/), у меня возникла идея развить тему самоорганизующихся клеточных автоматов. Здесь вы можете прочитать описание идеи.

## Предыстория: работы по самоорганизующимся клеточным автоматам

Ранее я видел ряд работ по созданию самоорганизующихся клеточных автоматов. Основная идея там в том, чтобы натренировать алгоритм [Клеточного автомата](https://ru.wikipedia.org/wiki/%D0%9A%D0%BB%D0%B5%D1%82%D0%BE%D1%87%D0%BD%D1%8B%D0%B9_%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82) так, чтобы в процессе эволюции решетки ячеек формировалось заранее заданное состояние. Например, решетка отображается на растр и автомат формирует изображение, а при стирании части изображения — восстанавливает ее.

Здесь есть подробное исследование на эту тему: https://distill.pub/2020/growing-ca/
![](https://distill.pub/2020/growing-ca/figures/rotation.png)

## Предыстория: Работы, которые меня вдохновили

### Video games

Невероятно милые игры, где действие происходит вокруг всяческих решеток, сеток и ферм: armadillo run, world of goo

![world of goo](https://cdn.gamestatic.net/files/editor_uploads/%D0%9D/0000005593.1920x1080.jpg)

### Работа художника Aizek

Сцена формируется множеством точек, соединенных линиями в большую сетку. Можно разглядеть элементы сетки, увидеть, как появляются и исчезают новые точки. Но вместе это становится похоже на динамично меняющуюся непрерывную среду, которая иногда выглядит как поверхность, иногда — как поток воды или газа.

more: [aizek.live/improv](https://aizek.live/improv)

![aizek improv](https://images.squarespace-cdn.com/content/v1/5aaa3d66f2e6b1f99071a61d/1554627095790-L17VIEQNJDVGXPJDZ93R/ke17ZwdGBToddI8pDm48kNvT88LknE-K9M4pGNO0Iqd7gQa3H78H3Y0txjaiv_0fDoOvxcdMmMKkDsyUqMSsMWxHk725yiiHCCLfrh8O1z5QPOohDIaIeljMHgDF5CVlOqpeNLcJ80NK65_fV7S1UbeDbaZv1s3QfpIA4TYnL5Qao8BosUKjCVjCf8TKewJIH3bqxw7fF48mhrq5Ulr0Hg/screenshot_9.png?format=780w)

### Примитивная полигональная графика

Я без ума от стильного вида фигур, состоящих из полигонов, без сложных текстур и освещения, если вы понимаете о чем я.

![teapot](https://axibase.com/use-cases/assets/img/utah_teapot.1db0060b.jpg)

# Основная идея

Моя идея в том, чтобы взять сетку (например четырехугольную), и каждое ребро в этой сетке представить ячейкой клеточного автомата. Параметром ячейки будет длина ребра, а соседними ячейками — ребра, выходящие из узлов, расположенных на концах ребра.

Алгоритм автомата будет смотреть на длины соседних ребер и менять собственную длину.

В процессе эволюции длины будут меняться, сетка — деформироваться. Планируется получить два эффекта:

1. Сетка деформируется и формирует заранее заданный объект (например, из четырехугольной сетки получается круг).
2. Сетка непрерывно деформируется, создавая эффект движения. Простым примером является глайдер из [Conway's Game of Life](https://ru.wikipedia.org/wiki/%D0%98%D0%B3%D1%80%D0%B0_%C2%AB%D0%96%D0%B8%D0%B7%D0%BD%D1%8C%C2%BB), только здесь он будет скорее похож на «выпуклость» на сетке, который перемещается по ней.

## Примеры «на бумажке»

Преобразование сетки в треугольник

<img src="https://raw.githubusercontent.com/aanper/mesh_cell/master/simple.jpg" alt="square to triangle" width="33%">

Преобразование сетки в круг

<img src="https://raw.githubusercontent.com/aanper/mesh_cell/master/circle_0.jpg" alt="square to circle" width="33%">

*(На самом деле круг получается как-то так)*

<img src="https://raw.githubusercontent.com/aanper/mesh_cell/master/circle_1.jpg" alt="advanced square to circle" width="33%">

## Приятный инструментальный бонус

Т.к. целевыми параметрами автомата являются геометрические параметры сетки (длины ребер), остается довольно много незадействованных параметров отрисовки (цвет и яркость точек, форма и цвет ребер, цвет фона). Все эти параметры можно использовать как художественные и отладочные инструменты. Например, привязать цвет точки к одному из внутренних параметров автомата и наблюдать как автоматы «принимают решения» о своем развитии.

## Задачи

1. Программная организация клеточного автомата на сетке: построить алгоритм инициализации сетки, поиска соседей.
2. Поиск координат узлов по заданным длинам ребер
3. Рендеринг сети
4. Создать инструмент, который позволит формировать training set (например, руками расставлять узлы сетки)
5. Собственно, погрузиться в ML часть. Для начала, понять, насколько применимы существующие разработки (автоматы, формирующие растровое изображение).

## Проблема геометрической реализуемости

На данный момент основной проблемой является то, что не всякий набор длин сетки может быть на самом деле нарисован. Если речь о треугольной сетке, то как минимум, должно соблюдаться неравенство треугольника.

Если пытаться рендерить треугольную сетку, на каком-то шаге можно столкнуться с тем, что длина ребра зависит от длин уже рассчитанных ребер.

Я вижу два выхода из ситуаиции:

1. В процессе тренировки алгоритма ставить цель получить такой алгоритм, который всегда будет давать геометрически реализуемую сетку. Например, на этапе расчета координат узлов водить «напряженность» ребер — разность между длиной ребра, которую расчитала ячейка автомата и реально расчитанной длиной, и эту напряженность использовать как одно из состояний ячейки. Возможно, потребуется распределять эту напряженность между всеми ребрами.
2. Исключить зависимые ребра из массива ячеек клеточного автомата, т.е. всегда работать с невырожденной сеткой.
